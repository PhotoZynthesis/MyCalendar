重构中的新版，主要解决多实例的问题。